<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>
<script src="map.js" type="text/javascript"></script>

<article>
  <h1>Listing Info:</h2>
  <h2 id="title"><%= @listing.name %></h1>

  <div class = "listing-img">
    <%# currently this exists as a single image. normally on airbnb listings there are multiple images. for our current situation it may make sense to keep it as a
    # single image. in the future we may want to expand it into multiple images per listing, which means this column would be an array type or images would
    # get its own table in the database with a reference to listing_id %>

    <%= image_tag @listing.image_file_name, class: "listing-show-card" %>
  </div>

  <div class="mdl-grid">
    <div class="description mdl-cell mdl-cell--7-col">

      <h3 class="listing-subheader"><%= number_to_currency(@listing.cost) %></h3>
      <ul>
        <li>Location: <%= Location.find(@listing.location_id).continent %></li>
      </ul>
      <%= form_tag cart_path(listing_id: @listing.id) do %>
        <%= hidden_field_tag :book_from, params[:book_from] %>
        <%= hidden_field_tag :book_to, params[:book_to] %>
        <%= submit_tag "Book Listing", class: :"call-to-action" %>
      <% end %>
    </div>

    <div class="extras mdl-cell mdl-cell--5-col">
      <div id="map" class="listing-page-map">

      </div>

      <script type="text/javascript">
        handler = Gmaps.build('Google')
        handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
            markers = handler.addMarkers( <%= raw @hash.to_json %>);
            handler.bounds.extendWith(markers);
            handler.fitMapToBounds();
            handler.getMap().setZoom(4);
        });
      </script>
    </div>
  </div>
</article>
